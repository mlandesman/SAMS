/newIA

You are Implementation Agent assigned to complete Tasks 1, 2, and 3 for Water Bills Complete Fix in SEQUENCE.

🚨 CRITICAL GIT RULES:
1. Work ONLY on branch: feature/water-bills-issues-0-7-complete-fix
2. NEVER merge to main
3. NEVER run: git merge, git push origin main, git checkout main && git merge
4. Report completion to Manager Agent who will handle merge after Product Manager approval

Complete Task 1 first, report results, then wait for approval before starting Task 2.

---

📖 KEY FILES TO READ:

1. START HERE guide: apm_session/IMPLEMENTATION_AGENT_START_HERE.md
2. Git Workflow: docs/GIT_WORKFLOW_FOR_WATER_BILLS_FIX.md
3. Task 1 Assignment: apm_session/Memory/Task_Assignments/Active/READY_FOR_ASSIGNMENT_Task_1.md
4. Task 2 Assignment: apm_session/Memory/Task_Assignments/Active/READY_FOR_ASSIGNMENT_Task_2.md
5. Task 3 Assignment: apm_session/Memory/Task_Assignments/Active/READY_FOR_ASSIGNMENT_Task_3.md

For detailed instructions, read:
- apm_session/Memory/Task_Assignments/Active/Task_1_Penalty_Calculation_Integration.md
- apm_session/Memory/Task_Assignments/Active/Task_2_Payment_Issues_Resolution.md
- apm_session/Memory/Task_Assignments/Active/Task_3_Delete_Reversal_Implementation.md

---

🎯 WORKFLOW:

1. Complete Task 1 → Test (5 tests) → Create Memory Log → Report via /manager-review-enhanced → STOP AND WAIT FOR MICHAEL'S APPROVAL

2. After approval: Complete Task 2 → Test (4 tests) → Create Memory Log → Report → STOP AND WAIT FOR MICHAEL'S APPROVAL

3. After approval: Complete Task 3 → Test (5 tests) → Create Memory Log → Report → FINAL COMPLETION

---

📋 TASK SUMMARY:

Task 1: Penalty Calculation Integration (3-4 hours)
- Problem: All units show $0 penalties
- Fix: Add penalty calc to existing nightly build + surgical updates
- Tests: 5 backend API tests required
- Files: backend/services/waterDataService.js

Task 2: Payment Issues Resolution (4-5 hours)
- Problem: 4 payment integration issues
- Fix: Use /credit endpoint, fix display logic
- Tests: 4 backend API tests required
- Files: backend/services/waterPaymentsService.js, frontend files

Task 3: Delete Reversal Implementation (2-3 hours)
- Problem: Delete function 70% incomplete (52 vs 175 lines)
- Fix: Copy HOA Dues pattern exactly
- Tests: 5 backend API tests required
- Files: backend/services/transactions/transactionsCleanupService.js

---

🚨 CRITICAL CONSTRAINTS:

DO:
✅ Work on feature branch only
✅ Read all documentation before coding
✅ Test thoroughly (90% backend API testing)
✅ Commit frequently with clear messages
✅ Create Memory Log for each task
✅ Stop after each task for approval

DO NOT:
❌ Work on main branch
❌ Merge to main (Manager will do this)
❌ Skip reading documentation
❌ Skip testing
❌ Create new cron jobs (integrate into existing)
❌ Proceed to next task without approval

---

📊 SUCCESS METRICS:

Task 1: All units show penalties > $0, penaltiesApplied = true
Task 2: Credit updates immediately, paid bills show $0 due
Task 3: Delete fully reverses payment, credit correct

Total Duration: 9-12 hours across all 3 tasks
Environment: Dev with fresh AVII data, Backend port 5001

---

🎯 YOUR MISSION:

Make Water Bills "rock solid" so it can be the reference implementation for HOA Dues and other modules.

All documentation is in the repository. Read the files listed above, then begin with Task 1.

STOP after each task and report completion using /manager-review-enhanced command.

